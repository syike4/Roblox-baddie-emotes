-- LocalScript (place in StarterPlayer > StarterPlayerScripts or use in an exploit)
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Basic device detection
local isMobile = UserInputService.TouchEnabled and not UserInputService.KeyboardEnabled and not UserInputService.MouseEnabled

-- Create ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "BaddiesToggles"
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui

-- MAIN TOGGLE BUTTON (MOVED HIGHER ON MOBILE - TOP TOP RIGHT)
local mainToggleButton = Instance.new("Frame")
mainToggleButton.Name = "MainToggleButton"

if isMobile then
    mainToggleButton.Size = UDim2.new(0, 32, 0, 32)
    mainToggleButton.Position = UDim2.new(1, -42, 0, -10)  -- MOVED UP MORE (negative Y for top top right)
else
    mainToggleButton.Size = UDim2.new(0, 35, 0, 35)
    mainToggleButton.Position = UDim2.new(1, -45, 0, -40)
end

mainToggleButton.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
mainToggleButton.BackgroundTransparency = 0.3
mainToggleButton.BorderSizePixel = 0
mainToggleButton.Active = true
mainToggleButton.Parent = screenGui

local mainToggleCorner = Instance.new("UICorner")
mainToggleCorner.CornerRadius = UDim.new(0, 8)
mainToggleCorner.Parent = mainToggleButton

local mainToggleGradient = Instance.new("UIGradient")
mainToggleGradient.Color = ColorSequence.new(Color3.fromRGB(0, 0, 0), Color3.fromRGB(200, 200, 200))
mainToggleGradient.Rotation = 90
mainToggleGradient.Parent = mainToggleButton

local mainToggleStroke = Instance.new("UIStroke")
mainToggleStroke.Color = Color3.fromRGB(0, 0, 0)
mainToggleStroke.Transparency = 0.6
mainToggleStroke.Thickness = 1
mainToggleStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
mainToggleStroke.Parent = mainToggleButton

-- BLACK CONTAINER FRAME with smooth bezels (adjusted for mobile)
local containerFrame = Instance.new("Frame")
containerFrame.Name = "AnimationContainer"
if isMobile then
    containerFrame.Size = UDim2.new(0, 220, 0, 300)
    containerFrame.Position = UDim2.new(1, -240, 0, 30)  -- ADJUSTED TO ALIGN WITH NEW BUTTON POSITION
else
    containerFrame.Size = UDim2.new(0, 240, 0, 350)
    containerFrame.Position = UDim2.new(1, -260, 0, 10)
end
containerFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
containerFrame.BackgroundTransparency = 0.15
containerFrame.BorderSizePixel = 0
containerFrame.Visible = false
containerFrame.Parent = screenGui

local containerCorner = Instance.new("UICorner")
containerCorner.CornerRadius = UDim.new(0, 12)
containerCorner.Parent = containerFrame

local containerGradient = Instance.new("UIGradient")
containerGradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(10, 10, 10)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(40, 40, 40))
}
containerGradient.Rotation = 90
containerGradient.Parent = containerFrame

local containerStroke = Instance.new("UIStroke")
containerStroke.Color = Color3.fromRGB(0, 0, 0)
containerStroke.Transparency = 0.4
containerStroke.Thickness = 2
containerStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
containerStroke.Parent = containerFrame

-- SCROLLER FRAME (transparent) - GRAY SCROLLBAR
local scrollingFrame = Instance.new("ScrollingFrame")
scrollingFrame.Name = "ToggleScroller"
scrollingFrame.Size = UDim2.new(1, -20, 1, -20)
scrollingFrame.Position = UDim2.new(0, 10, 0, 10)
scrollingFrame.BackgroundTransparency = 1
scrollingFrame.BorderSizePixel = 0
scrollingFrame.ScrollBarThickness = 4
scrollingFrame.ScrollBarImageColor3 = Color3.fromRGB(150, 150, 150)  -- GRAY SCROLLBAR
scrollingFrame.ScrollBarImageTransparency = 0.5
scrollingFrame.CanvasSize = UDim2.new(0, 0, 0, 800)
scrollingFrame.Parent = containerFrame

local listLayout = Instance.new("UIListLayout")
listLayout.SortOrder = Enum.SortOrder.LayoutOrder
listLayout.Padding = UDim.new(0, 4)
listLayout.Parent = scrollingFrame

-- Common colors
local black = Color3.new(0, 0, 0)
local offColor = Color3.fromRGB(255, 69, 58)
local onColor = Color3.fromRGB(76, 209, 55)
local offSequence = ColorSequence.new(black, offColor)
local onSequence = ColorSequence.new(black, onColor)

-- Create sound for Cute Jiggly Needy Shake
local needyShakeSound = Instance.new("Sound")
needyShakeSound.SoundId = "rbxassetid://13332221546"
needyShakeSound.Volume = 1
needyShakeSound.Looped = true
needyShakeSound.PlaybackSpeed = 0.6  -- Match animation speed
needyShakeSound.Parent = game:GetService("SoundService")

-- Toggles data
local toggles = {
    {name = "Baddies Split", animationId = "85195857579576", isToggled = false, animTrack = nil, label = nil, dot = nil, dotGradient = nil},
    {name = "baddie shake in a circle", animationId = "125243378417931", isToggled = false, animTrack = nil, label = nil, dot = nil, dotGradient = nil},
    {name = "Needy Dance", animationId = "81991457430301", isToggled = false, animTrack = nil, label = nil, dot = nil, dotGradient = nil},
    {name = "Slow Shake", animationId = "128156281604243", isToggled = false, animTrack = nil, label = nil, dot = nil, dotGradient = nil},
    {name = "Stretch", animationId = "119377401608190", isToggled = false, animTrack = nil, label = nil, dot = nil, dotGradient = nil},
    {name = "Bend Over", animationId = "122195322227561", isToggled = false, animTrack = nil, label = nil, dot = nil, dotGradient = nil, looped = false},
    {name = "Hula Hoop", animationId = "99067166854642", isToggled = false, animTrack = nil, label = nil, dot = nil, dotGradient = nil},
    {name = "Windy Shake", animationId = "119055944394046", isToggled = false, animTrack = nil, label = nil, dot = nil, dotGradient = nil},
    {name = "Cute sitting pose", animationId = "99430742775879", isToggled = false, animTrack = nil, label = nil, dot = nil, dotGradient = nil},
    {name = "Tail Wag", animationId = "72379586208471", isToggled = false, animTrack = nil, label = nil, dot = nil, dotGradient = nil},
    {name = "Lay (WAG)", animationId = "103786264517827", isToggled = false, animTrack = nil, label = nil, dot = nil, dotGradient = nil},
    {name = "On Knees", animationId = "77288841082275", isToggled = false, animTrack = nil, label = nil, dot = nil, dotGradient = nil},
    {name = "Stretch bend", animationId = "96330627404293", isToggled = false, animTrack = nil, label = nil, dot = nil, dotGradient = nil},
    {name = "Split While Laying", animationId = "100179668392253", isToggled = false, animTrack = nil, label = nil, dot = nil, dotGradient = nil},
    {name = "Cute Sitting Down", animationId = "74979648047173", isToggled = false, animTrack = nil, label = nil, dot = nil, dotGradient = nil},
    {name = "Hip Sway", animationId = "121983227909457", isToggled = false, animTrack = nil, label = nil, dot = nil, dotGradient = nil},
    {name = "Cute Jiggly Needy Shake", animationId = "87387281711244", isToggled = false, animTrack = nil, label = nil, dot = nil, dotGradient = nil, hasSound = true},  -- FLAG FOR SOUND
    {name = "spicy needy diva bouncy shake", animationId = "139957058984926", isToggled = false, animTrack = nil, label = nil, dot = nil, dotGradient = nil},
    {name = "Rabbit Shake", animationId = "117394346715743", isToggled = false, animTrack = nil, label = nil, dot = nil, dotGradient = nil},
    {name = "Kawaii Bounce", animationId = "127118661424463", isToggled = false, animTrack = nil, label = nil, dot = nil, dotGradient = nil}
}

-- Stop ALL other animations (and sound if needed)
local function stopAllAnimations(exceptToggle)
    for _, t in ipairs(toggles) do
        if t ~= exceptToggle then
            t.isToggled = false
            if t.animTrack then
                t.animTrack:Stop()
                t.animTrack:Destroy()
                t.animTrack = nil
            end
            -- Stop sound if it was playing
            if t.hasSound and needyShakeSound.Playing then
                needyShakeSound:Stop()
            end
            if t.label and t.dotGradient then
                local targetTextColor = Color3.fromRGB(200, 200, 200)
                TweenService:Create(t.label, TweenInfo.new(0.2, Enum.EasingStyle.Quad), {TextColor3 = targetTextColor}):Play()
                t.dotGradient.Color = offSequence
            end
        end
    end
end

local function toggleAnimation(toggle)
    local character = player.Character
    if not character then return end
    local humanoid = character:FindFirstChildOfClass("Humanoid")
    if not humanoid then return end
    
    if toggle.animTrack then
        toggle.animTrack:Stop()
        toggle.animTrack:Destroy()
        toggle.animTrack = nil
    end
    
    if toggle.isToggled then
        stopAllAnimations(toggle)
        for _, track in pairs(humanoid:GetPlayingAnimationTracks()) do
            track:Stop()
        end
        
        local animation = Instance.new("Animation")
        animation.AnimationId = "rbxassetid://" .. toggle.animationId
        toggle.animTrack = humanoid:LoadAnimation(animation)
        toggle.animTrack.Looped = toggle.looped ~= false
        toggle.animTrack:Play()
        
        -- Play sound if this animation has sound
        if toggle.hasSound then
            needyShakeSound:Play()
        end
        
        if toggle.looped == false then
            toggle.animTrack.Stopped:Connect(function()
                if toggle.isToggled then
                    toggle.isToggled = false
                    if toggle.label and toggle.dotGradient then
                        local targetTextColor = Color3.fromRGB(200, 200, 200)
                        TweenService:Create(toggle.label, TweenInfo.new(0.2, Enum.EasingStyle.Quad), {TextColor3 = targetTextColor}):Play()
                        
                        local tweenTime = 0.2
                        local startTime = tick()
                        local startSequence = toggle.dotGradient.Color
                        local connection
                        connection = RunService.RenderStepped:Connect(function()
                            local elapsed = tick() - startTime
                            local alpha = math.clamp(elapsed / tweenTime, 0, 1)
                            local lerpedColor1 = startSequence.Keypoints[1].Value:Lerp(offSequence.Keypoints[1].Value, alpha)
                            local lerpedColor2 = startSequence.Keypoints[2].Value:Lerp(offSequence.Keypoints[2].Value, alpha)
                            toggle.dotGradient.Color = ColorSequence.new(lerpedColor1, lerpedColor2)
                            if alpha >= 1 then
                                connection:Disconnect()
                            end
                        end)
                    end
                end
            end)
        end
    else
        -- Animation turned off, stop sound if it's playing
        if toggle.hasSound and needyShakeSound.Playing then
            needyShakeSound:Stop()
        end
    end
end

-- Create toggle buttons INSIDE scroller
for i, toggle in ipairs(toggles) do
    local toggleButton = Instance.new("TextButton")
    toggleButton.Name = toggle.name .. "Button"
    toggleButton.Size = UDim2.new(1, -10, 0, isMobile and 34 or 40)
    toggleButton.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    toggleButton.BackgroundTransparency = 0.4
    toggleButton.BorderSizePixel = 0
    toggleButton.Text = ""
    toggleButton.AutoButtonColor = false
    toggleButton.LayoutOrder = i
    toggleButton.Parent = scrollingFrame

    local buttonCorner = Instance.new("UICorner")
    buttonCorner.CornerRadius = UDim.new(0, 8)
    buttonCorner.Parent = toggleButton

    local buttonGradient = Instance.new("UIGradient")
    buttonGradient.Color = ColorSequence.new(Color3.fromRGB(0, 0, 0), Color3.fromRGB(200, 200, 200))
    buttonGradient.Rotation = 90
    buttonGradient.Parent = toggleButton

    local buttonStroke = Instance.new("UIStroke")
    buttonStroke.Color = Color3.fromRGB(0, 0, 0)
    buttonStroke.Transparency = 0.6
    buttonStroke.Thickness = 1
    buttonStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    buttonStroke.Parent = toggleButton

    local toggleLabel = Instance.new("TextLabel")
    toggleLabel.Name = "ToggleLabel"
    toggleLabel.Size = UDim2.new(1, -30, 1, 0)
    toggleLabel.Position = UDim2.new(0, 8, 0, 0)
    toggleLabel.BackgroundTransparency = 1
    toggleLabel.Text = toggle.name
    toggleLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
    toggleLabel.TextSize = isMobile and 13 or 14
    toggleLabel.Font = Enum.Font.GothamSemibold
    toggleLabel.TextXAlignment = Enum.TextXAlignment.Left
    toggleLabel.TextYAlignment = Enum.TextYAlignment.Center
    toggleLabel.TextTransparency = 0.3
    toggleLabel.Parent = toggleButton
    toggle.label = toggleLabel

    local toggleDot = Instance.new("Frame")
    toggleDot.Name = "ToggleDot"
    toggleDot.Size = UDim2.new(0, 12, 0, 12)
    toggleDot.Position = UDim2.new(1, -20, 0.5, -6)
    toggleDot.BackgroundColor3 = Color3.new(1, 1, 1)
    toggleDot.BorderSizePixel = 0
    toggleDot.BackgroundTransparency = 0.3
    toggleDot.Parent = toggleButton
    toggle.dot = toggleDot

    local toggleDotCorner = Instance.new("UICorner")
    toggleDotCorner.CornerRadius = UDim.new(1, 0)
    toggleDotCorner.Parent = toggleDot

    local toggleDotGradient = Instance.new("UIGradient")
    toggleDotGradient.Color = offSequence
    toggleDotGradient.Rotation = 90
    toggleDotGradient.Parent = toggleDot
    toggle.dotGradient = toggleDotGradient

    local function handleToggle()
        toggle.isToggled = not toggle.isToggled
        local targetTextColor = toggle.isToggled and Color3.fromRGB(76, 209, 55) or Color3.fromRGB(200, 200, 200)
        local targetSequence = toggle.isToggled and onSequence or offSequence
        local startSequence = toggleDotGradient.Color
        
        TweenService:Create(toggleLabel, TweenInfo.new(0.2, Enum.EasingStyle.Quad), {TextColor3 = targetTextColor}):Play()
        
        local tweenTime = 0.2
        local startTime = tick()
        local connection
        connection = RunService.RenderStepped:Connect(function()
            local elapsed = tick() - startTime
            local alpha = math.clamp(elapsed / tweenTime, 0, 1)
            local lerpedColor1 = startSequence.Keypoints[1].Value:Lerp(targetSequence.Keypoints[1].Value, alpha)
            local lerpedColor2 = startSequence.Keypoints[2].Value:Lerp(targetSequence.Keypoints[2].Value, alpha)
            toggleDotGradient.Color = ColorSequence.new(lerpedColor1, lerpedColor2)
            if alpha >= 1 then
                connection:Disconnect()
            end
        end)
        
        toggleAnimation(toggle)
    end

    toggleButton.Activated:Connect(handleToggle)

    toggleButton.MouseEnter:Connect(function()
        local hoverTextColor = toggle.isToggled and Color3.fromRGB(120, 255, 100) or Color3.fromRGB(230, 230, 230)
        TweenService:Create(toggleLabel, TweenInfo.new(0.15, Enum.EasingStyle.Quad), {TextColor3 = hoverTextColor}):Play()
        TweenService:Create(toggleButton, TweenInfo.new(0.15, Enum.EasingStyle.Quad), {BackgroundTransparency = 0.2}):Play()
        TweenService:Create(toggleDot, TweenInfo.new(0.15, Enum.EasingStyle.Quad), {BackgroundTransparency = 0}):Play()
    end)

    toggleButton.MouseLeave:Connect(function()
        local targetTextColor = toggle.isToggled and Color3.fromRGB(76, 209, 55) or Color3.fromRGB(200, 200, 200)
        TweenService:Create(toggleLabel, TweenInfo.new(0.15, Enum.EasingStyle.Quad), {TextColor3 = targetTextColor}):Play()
        TweenService:Create(toggleButton, TweenInfo.new(0.15, Enum.EasingStyle.Quad), {BackgroundTransparency = 0.4}):Play()
        TweenService:Create(toggleDot, TweenInfo.new(0.15, Enum.EasingStyle.Quad), {BackgroundTransparency = 0.3}):Play()
    end)
end

-- Update canvas size when list changes
listLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    scrollingFrame.CanvasSize = UDim2.new(0, 0, 0, listLayout.AbsoluteContentSize.Y + 10)
end)

-- Menu toggle
local menuVisible = false
local function toggleMenu()
    menuVisible = not menuVisible
    
    if menuVisible then
        containerFrame.Visible = true
        TweenService:Create(containerFrame, TweenInfo.new(0.4, Enum.EasingStyle.Sine, Enum.EasingDirection.Out), {
            BackgroundTransparency = 0.15
        }):Play()
        TweenService:Create(containerStroke, TweenInfo.new(0.4, Enum.EasingStyle.Sine, Enum.EasingDirection.Out), {
            Transparency = 0.4
        }):Play()
        
        for _, toggle in ipairs(toggles) do
            local button = scrollingFrame:FindFirstChild(toggle.name .. "Button")
            if button then
                local buttonStroke = button:FindFirstChildOfClass("UIStroke")
                TweenService:Create(button, TweenInfo.new(0.3, Enum.EasingStyle.Sine, Enum.EasingDirection.Out), {
                    BackgroundTransparency = 0.4
                }):Play()
                if buttonStroke then
                    TweenService:Create(buttonStroke, TweenInfo.new(0.3, Enum.EasingStyle.Sine), {Transparency = 0.6}):Play()
                end
                TweenService:Create(toggle.label, TweenInfo.new(0.3, Enum.EasingStyle.Sine), {TextTransparency = 0}):Play()
                TweenService:Create(toggle.dot, TweenInfo.new(0.3, Enum.EasingStyle.Sine), {BackgroundTransparency = 0.3}):Play()
            end
        end
    else
        TweenService:Create(containerFrame, TweenInfo.new(0.4, Enum.EasingStyle.Sine, Enum.EasingDirection.In), {
            BackgroundTransparency = 1
        }):Play()
        TweenService:Create(containerStroke, TweenInfo.new(0.4, Enum.EasingStyle.Sine, Enum.EasingDirection.In), {
            Transparency = 1
        }):Play()
        
        for _, toggle in ipairs(toggles) do
            local button = scrollingFrame:FindFirstChild(toggle.name .. "Button")
            if button then
                local buttonStroke = button:FindFirstChildOfClass("UIStroke")
                TweenService:Create(button, TweenInfo.new(0.3, Enum.EasingStyle.Sine), {BackgroundTransparency = 1}):Play()
                if buttonStroke then
                    TweenService:Create(buttonStroke, TweenInfo.new(0.3, Enum.EasingStyle.Sine), {Transparency = 1}):Play()
                end
                TweenService:Create(toggle.label, TweenInfo.new(0.3, Enum.EasingStyle.Sine), {TextTransparency = 1}):Play()
                TweenService:Create(toggle.dot, TweenInfo.new(0.3, Enum.EasingStyle.Sine), {BackgroundTransparency = 1}):Play()
            end
        end
        
        task.delay(0.4, function()
            containerFrame.Visible = false
        end)
    end
end

mainToggleButton.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        toggleMenu()
    end
end)

mainToggleButton.MouseEnter:Connect(function()
    TweenService:Create(mainToggleButton, TweenInfo.new(0.2, Enum.EasingStyle.Quad), {BackgroundTransparency = 0.1}):Play()
    TweenService:Create(mainToggleStroke, TweenInfo.new(0.2, Enum.EasingStyle.Quad), {Transparency = 0.2}):Play()
end)

mainToggleButton.MouseLeave:Connect(function()
    TweenService:Create(mainToggleButton, TweenInfo.new(0.2, Enum.EasingStyle.Quad), {BackgroundTransparency = 0.3}):Play()
    TweenService:Create(mainToggleStroke, TweenInfo.new(0.2, Enum.EasingStyle.Quad), {Transparency = 0.5}):Play()
end)

player.CharacterAdded:Connect(function(character)
    local humanoid = character:WaitForChild("Humanoid")
    humanoid:WaitForChild("Animator")
    for _, toggle in ipairs(toggles) do
        if toggle.isToggled then
            toggleAnimation(toggle)
        end
    end
end)
